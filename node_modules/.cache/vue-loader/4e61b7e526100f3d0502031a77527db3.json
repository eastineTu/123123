{"remainingRequest":"/Users/wuchao/Documents/H5/testOne/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wuchao/Documents/H5/testOne/src/components/uploadImg.vue?vue&type=style&index=0&id=05131a48&lang=stylus&scoped=true&","dependencies":[{"path":"/Users/wuchao/Documents/H5/testOne/src/components/uploadImg.vue","mtime":1562420064592},{"path":"/Users/wuchao/Documents/H5/testOne/node_modules/css-loader/index.js","mtime":1562420059133},{"path":"/Users/wuchao/Documents/H5/testOne/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1562420064291},{"path":"/Users/wuchao/Documents/H5/testOne/node_modules/postcss-loader/src/index.js","mtime":1562420062379},{"path":"/Users/wuchao/Documents/H5/testOne/node_modules/stylus-loader/index.js","mtime":1562420063969},{"path":"/Users/wuchao/Documents/H5/testOne/node_modules/cache-loader/dist/cjs.js","mtime":1562420058310},{"path":"/Users/wuchao/Documents/H5/testOne/node_modules/vue-loader/lib/index.js","mtime":1562420064290}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.uploadImg\n    width 100%\n    overflow-x hidden\n    display flex\n    text-align center\n    .uploadImg_list_item\n        margin auto\n        position relative\n        transition all 0.3s linear\n        .uploadImg_list_item_img\n            width 100%\n            height 100%\n    .uploadImg_pop\n        margin auto\n        width 180px\n        height 180px\n        line-height 180px\n        text-align center\n        overflow hidden\n        position relative\n        img\n            width 180px\n            height 180px\n        input[type='file']\n            position absolute\n            left 0\n            top 0\n            width 100%\n            height 100%\n            opacity: 0;\n    .overLoading\n        display: none;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: #f5f5f5;\n        opacity:0.5;\n        z-index: 1000;\n    .layoutLoading\n        display: none;\n        position: absolute;\n        top: 40%;\n        left: 40%;\n        width: 20%;\n        height: 20%;\n        z-index: 1001;\n        text-align:center;\n",{"version":3,"sources":["uploadImg.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"uploadImg.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"uploadImg\" id=\"uploadImg\">\n        <div class=\"uploadImg_pop\">\n            <img alt=\"\" :src=\"imgSrc\">\n            <input id=\"profilePhotoFileUpload\" v-if=\"upType\" type=\"file\" @change=\"getFile\" accept=\"image/*\" :capture=\"upType\"/>\n            <input v-else type=\"file\" @change=\"getFile\" accept=\"image/*\"/>\n        </div>\n        <div id=\"over\" class=\"overLoading\"></div>\n        <div id=\"layout\" class=\"layoutLoading\"><img src=\"../assets/loding.gif\" /></div>\n    </div>\n</template>\n<script>\n    export default {\n        name: 'uploadimg',\n        props: {\n            upType: {\n                type: String,\n                default: ''\n            },\n            imgSrc: {}\n        },\n        data() {\n            return {\n            }\n        },\n        methods: {\n            // 选择图片并上传\n            getFile(e) {\n                let file = e.target.files[0]\n                if (!file) return\n                this.imgSrc = window.URL.createObjectURL(file)\n\n                this.$bmob.initialize('6cc51f95f96811441ba8e4754ac01f26', 'f3037695274e2983ee6b99b7e3e952b0')\n                let bmobFile = this.$bmob.File(file.name, file);\n                this.$emit('progress', 50)\n                this.showLoading(true)\n                bmobFile.save().then(res => {\n                    this.showLoading(false)\n                    this.$emit('imageSrc', res[0])\n                    this.$emit('progress', 100)\n                })\n            },\n            showLoading(show){\n                if(show){\n                    document.getElementById(\"over\").style.display = \"block\";\n                    document.getElementById(\"layout\").style.display = \"block\";\n                }else{\n                    document.getElementById(\"over\").style.display = \"none\";\n                    document.getElementById(\"layout\").style.display = \"none\";\n                }\n\n            },\n            photoCompress(file,w,objDiv){\n                if(file.tagName.toLocaleLowerCase()==\"img\"){\n                    this.canvasDataURL(file.src,w,objDiv);\n                    return false;\n                }\n                var ready=new FileReader();\n                /*开始读取指定的Blob对象或File对象中的内容. 当读取操作完成时,readyState属性的值会成为DONE,如果设置了onloadend事件处理程序,则调用之.同时,result属性中将包含一个data: URL格式的字符串以表示所读取文件的内容.*/\n                ready.readAsDataURL(file);\n                ready.onload=function(){\n                    var re=this.result;\n                    this.canvasDataURL(re,w,objDiv)\n                }\n            },\n            canvasDataURL(re,w,objDiv){\n                var newImg=new Image();\n                newImg.src=re;\n                var imgWidth,imgHeight,offsetX=0,offsetY=0;\n                newImg.onload=function(){\n                    var img=document.createElement(\"img\");\n                    img.src=newImg.src;\n                    imgWidth=img.width;\n                    imgHeight=img.height;\n                    var canvas=document.createElement(\"canvas\");\n                    canvas.width=w;\n                    canvas.height=w;\n                    var ctx=canvas.getContext(\"2d\");\n                    ctx.clearRect(0,0,w,w);\n                    if(imgWidth>imgHeight){\n                        imgWidth=w*imgWidth/imgHeight;\n                        imgHeight=w;\n                        offsetX=-Math.round((imgWidth-w)/2);\n                    }else{\n                        imgHeight=w*imgHeight/imgWidth;\n                        imgWidth=w;\n                        offsetY=-Math.round((imgHeight-w)/2);\n                    }\n                    ctx.drawImage(img,offsetX,offsetY,imgWidth,imgHeight);\n                    var base64=canvas.toDataURL(\"image/jpeg\",0.7);\n                    if(typeof objDiv == \"object\"){\n                        objDiv.appendChild(canvas);\n                    }else if(typeof objDiv==\"function\"){\n                        objDiv(base64);\n                    }\n                }\n        }\n        },\n        created () {\n        }\n    }\n</script>\n<style lang=\"stylus\" scoped>\n    .uploadImg\n        width 100%\n        overflow-x hidden\n        display flex\n        text-align center\n        .uploadImg_list_item\n            margin auto\n            position relative\n            transition all 0.3s linear\n            .uploadImg_list_item_img\n                width 100%\n                height 100%\n        .uploadImg_pop\n            margin auto\n            width 180px\n            height 180px\n            line-height 180px\n            text-align center\n            overflow hidden\n            position relative\n            img\n                width 180px\n                height 180px\n            input[type='file']\n                position absolute\n                left 0\n                top 0\n                width 100%\n                height 100%\n                opacity: 0;\n        .overLoading\n            display: none;\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: #f5f5f5;\n            opacity:0.5;\n            z-index: 1000;\n        .layoutLoading\n            display: none;\n            position: absolute;\n            top: 40%;\n            left: 40%;\n            width: 20%;\n            height: 20%;\n            z-index: 1001;\n            text-align:center;\n</style>\n"]}]}